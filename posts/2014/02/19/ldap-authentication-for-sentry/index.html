<!DOCTYPE html>
<html lang="en">
<head>

        <title>LDAP Authentication for Sentry</title>
        <meta charset="utf-8" />
        <link href="http://blog.lance.tw/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Lance's blog Full Atom Feed" />
        <link href="http://blog.lance.tw/feeds/posts.atom.xml" type="application/atom+xml" rel="alternate" title="Lance's blog Categories Atom Feed" />


        <!-- Mobile viewport optimized: j.mp/bplateviewport -->
        <meta name="viewport" content="width=device-width,initial-scale=1, maximum-scale=1">

        <link rel="stylesheet" type="text/css" href="http://blog.lance.tw/theme/my.min.css?9db2a104" />

        <script src="http://blog.lance.tw/theme/js/libs/modernizr-2.6.2.min.js"></script>


              <script>
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

                ga('create', 'UA-42632450-1', '');
                ga('send', 'pageview');

              </script>




</head>

<body id="index" class="home">


    <div class="container">

        <div class="row">

          <header id="banner" class="body">
                  <h1><a href="http://blog.lance.tw">Lance's blog <strong></strong></a></h1>
          </header><!-- /#banner -->

            <div id="navigation" class="navbar row">
              <a href="#" gumby-trigger="#navigation &gt; ul" class="toggle"><i class="icon-menu"></i></a>
             
              <ul class="columns">
                <li><a href="http://blog.lance.tw">Home</a></li>

                <li><a href="/archives.html">Archives</a></li>
                <li><a href="http://blog.lance.tw/pages/about.html">About</a></li>

              </ul>
            </div>

<section id="content" class="body">

   <div class="row">
        <div class="eleven columns">


            <header>
              <h2 class="entry-title">
                <a href="http://blog.lance.tw/posts/2014/02/19/ldap-authentication-for-sentry/" rel="bookmark"
                   title="Permalink to LDAP Authentication for Sentry">LDAP Authentication for Sentry</a></h2>
           
            </header>
            <footer class="post-info">
              <abbr class="published" title="2014-02-19T18:30:00">
                Wed 19 February 2014
              </abbr>
              <address class="vcard author">
                By <a class="url fn" href="http://blog.lance.tw/author/lance-chen.html">Lance Chen</a>
              </address>
            </footer><!-- /.post-info -->
            <div class="entry-content">
              <p><a href="https://getsentry.com">Sentry</a> is an awesome error logging platform for
various language platforms and web frameworks. And it also supports several
social authentication backends, including Twitter, Facebook, Google, Github,
Trello and Bitbucket. However, if you are trying to set up Sentry for a
company or an organization, you would probably want to plug in an existed
authentication method, such as LDAP or AD. With
<a href="https://docs.djangoproject.com/en/dev/misc/design-philosophies/">Django's design philosophies</a> - loose coupling and DRY, it is pretty
easy to plug in your preferred <a href="https://pypi.python.org/pypi?%3Aaction=search&amp;term=django+auth" title="django-auth-*">authentication backends</a>. Below is an
example using <a href="https://pythonhosted.org/django-auth-ldap/">django-auth-ldap</a> as a substitution of original database
and social authentication backends. Just append the following settings to
your <code>sentry.conf.py</code> generated by <code>sentry init sentry.conf.py</code>.
Remember to install django-auth-ldap before restarting sentry.</p>
<div class="gist">
    <script src='https://gist.github.com/9089843.js'></script>
    <noscript>
        <pre><code>import ldap

# ldap server settings
AUTH_LDAP_SERVER_URI = "ldap://ldap.example.com"
AUTH_LDAP_START_TLS = True

# User DN for authentication
AUTH_LDAP_USER_DN_TEMPLATE = 'uid=%(user)s,ou=People,dc=example,dc=com'

# Restrict log in to only members that belong to staff group
from django_auth_ldap.config import LDAPSearch, PosixGroupType
AUTH_LDAP_GROUP_SEARCH = LDAPSearch(
    "ou=Group,dc=example,dc=com",
    ldap.SCOPE_SUBTREE,
    "(objectClass=posixGroup)"
)
AUTH_LDAP_GROUP_TYPE = PosixGroupType()
AUTH_LDAP_REQUIRE_GROUP = "cn=staff,ou=Group,dc=example,dc=com"

# Override AUTHENTICATION_BACKENDS
AUTHENTICATION_BACKENDS = (
    'django_auth_ldap.backend.LDAPBackend',
)

# Preserve original database auth backend and social auth backends.
# AUTHENTICATION_BACKENDS = AUTHENTICATION_BACKENDS + (
#     'django_auth_ldap.backend.LDAPBackend',
# )

# To be able to create projects/teams, is_superuser flag is needed.
# AUTH_LDAP_USER_FLAGS_BY_GROUP = {
#     "is_active": "cn=active,ou=Group,dc=example,dc=com",
#     "is_staff": "cn=staff,ou=Group,dc=example,dc=com",
#     "is_superuser": "cn=superuser,ou=Group,dc=example,dc=com"
# }</code></pre>
    </noscript>
</div>
            </div><!-- /.entry-content -->
            <hr>
            <div class="addthis_native_toolbox"></div>
            <div class="comments">
              <h3>Comments</h3>
              <div id="disqus_thread"></div>
              <script type="text/javascript">
                var disqus_identifier = "posts/2014/02/19/ldap-authentication-for-sentry/";
                (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = 'http://bloglancetw.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
              </script>
            </div>


        </div><!-- /.eleven.columns -->
        
<div class="three columns">

<h4>Tags</h4>
	<ul>
	    <li class="tag-1"><a href="http://blog.lance.tw/tag/freebsd.html">FreeBSD</a></li>
	    <li class="tag-4"><a href="http://blog.lance.tw/tag/bash.html">Bash</a></li>
	    <li class="tag-4"><a href="http://blog.lance.tw/tag/vim.html">Vim</a></li>
	    <li class="tag-4"><a href="http://blog.lance.tw/tag/sentry.html">Sentry</a></li>
	    <li class="tag-4"><a href="http://blog.lance.tw/tag/django.html">Django</a></li>
	    <li class="tag-4"><a href="http://blog.lance.tw/tag/mutt.html">Mutt</a></li>
	    <li class="tag-4"><a href="http://blog.lance.tw/tag/archlinux.html">Archlinux</a></li>
	    <li class="tag-1"><a href="http://blog.lance.tw/tag/python.html">Python</a></li>
	    <li class="tag-4"><a href="http://blog.lance.tw/tag/cli.html">Cli</a></li>
	    <li class="tag-1"><a href="http://blog.lance.tw/tag/git.html">Git</a></li>
	    <li class="tag-4"><a href="http://blog.lance.tw/tag/data-structure.html">Data structure</a></li>
</ul>



</div> </div><!-- /.row -->


</section>

       </div><!-- /.row -->
    </div><!-- /.container -->


       <div class="container.nopad bg">

    
        <footer id="credits" class="row">
          <div class="seven columns left-center">

                   <address id="about" class="vcard body">
                    Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
                    which takes great advantage of <a href="http://python.org">Python</a>.
                    <br />
                    Based on the <a target="_blank" href="http://gumbyframework.com">Gumby Framework</a>
                    </address>
          </div>


          <div class="seven columns">
            <div class="row">
              <ul class="socbtns">

                <li><div class="btn primary"><a href="https://github.com/Lance0312" target="_blank">Github</a></div></li>

                <li><div class="btn twitter"><a href="https://twitter.com/Lance0312" target="_blank">Twitter</a></div></li>



              </ul>
            </div>
          </div>
        </footer>

    </div>


<script type="text/javascript">
    var disqus_shortname = 'bloglancetw';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-53d870897d773f31"></script>
  <script src="http://blog.lance.tw/theme/js/libs/jquery-1.9.1.min.js"></script>
  <script src="http://blog.lance.tw/theme/js/libs/gumby.min.js"></script>
  <script src="http://blog.lance.tw/theme/js/plugins.js"></script>

</body>
</html>